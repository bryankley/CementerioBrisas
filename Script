create database CementerioBrisas;
USE [CementerioBrisas]
GO
/****** Object:  Table [dbo].[asigna_mantenimiento]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[asigna_mantenimiento](
	[id_asignacion] [int] NOT NULL,
	[fecha_inicio] [date] NULL,
	[fecha_cierra] [date] NULL,
	[cedula_emplpk] [int] NULL,
	[idtipopk] [int] NULL,
	[idmantenimientopk] [int] NULL,
 CONSTRAINT [PK_asigna_mantenimiento] PRIMARY KEY CLUSTERED 
(
	[id_asignacion] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[catg_empleado]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[catg_empleado](
	[id_categoria] [int] NOT NULL,
	[descripcion_catg] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[certificado_defuncion]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[certificado_defuncion](
	[idcertificado] [int] NOT NULL,
	[fecha_fallecimiento] [date] NULL,
	[causa_fallecimiento] [varchar](70) NULL,
	[idfallecidopk] [int] NULL,
	[cedulapk] [int] NULL,
 CONSTRAINT [PK_certificado_defuncion] PRIMARY KEY CLUSTERED 
(
	[idcertificado] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[compra_panteon]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[compra_panteon](
	[id_panteon] [int] NOT NULL,
	[precio] [decimal](6, 2) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[compra_panteones]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[compra_panteones](
	[id_panteon] [int] NOT NULL,
	[precio] [decimal](6, 2) NULL,
	[idtipopk] [int] NULL,
	[idsectorpk] [int] NULL,
	[cedulapk] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_panteon] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[empleado]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[empleado](
	[cedula_empl] [int] NOT NULL,
	[nombres_e] [varchar](50) NULL,
	[apellidos_e] [varchar](50) NULL,
	[telefono] [int] NULL,
	[salario] [decimal](6, 2) NULL,
	[idcategoriapk] [int] NOT NULL,
 CONSTRAINT [PK_empleado] PRIMARY KEY CLUSTERED 
(
	[cedula_empl] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[fallecido]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[fallecido](
	[id_fallecido] [int] NOT NULL,
	[nombresf] [varchar](60) NULL,
	[apellidosf] [varchar](60) NULL,
	[edad] [int] NULL,
 CONSTRAINT [PK_fallecido] PRIMARY KEY CLUSTERED 
(
	[id_fallecido] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[familiar]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[familiar](
	[cedula] [int] NOT NULL,
	[nombres] [varchar](50) NULL,
	[apellidos] [varchar](50) NULL,
	[direccion] [varchar](50) NULL,
	[telefono] [int] NULL,
	[correo] [varchar](50) NULL,
 CONSTRAINT [PK_familiar] PRIMARY KEY CLUSTERED 
(
	[cedula] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mantenimiento]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mantenimiento](
	[id_mantenimiento] [int] NOT NULL,
	[descripcion_man] [varchar](60) NULL,
 CONSTRAINT [PK_mantenimiento] PRIMARY KEY CLUSTERED 
(
	[id_mantenimiento] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[sector]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[sector](
	[id_sector] [int] NOT NULL,
	[descripcion_sec] [varchar](40) NULL,
	[total_num_tumbas] [int] NULL,
 CONSTRAINT [PK_sector] PRIMARY KEY CLUSTERED 
(
	[id_sector] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[servicio]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[servicio](
	[id_servicio] [int] NOT NULL,
	[tipo_servicio] [varchar](60) NULL,
	[precio_servicio] [decimal](6, 2) NULL,
 CONSTRAINT [PK_servicio] PRIMARY KEY CLUSTERED 
(
	[id_servicio] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[servicio_prestados]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[servicio_prestados](
	[id] [int] NOT NULL,
	[idtipopk] [int] NULL,
	[idfallecidopk] [int] NULL,
	[cedula_emplpk] [int] NULL,
	[idserviciopk] [int] NULL,
	[descripcion_servicio] [varchar](70) NULL,
	[fecha] [date] NULL,
 CONSTRAINT [PK_servicio_prestados] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[tipo_tumba]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tipo_tumba](
	[id_tipo] [int] NOT NULL,
	[nombre_tumba] [varchar](50) NULL,
 CONSTRAINT [PK_tipo_tumba] PRIMARY KEY CLUSTERED 
(
	[id_tipo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[tumba]    Script Date: 12/6/2021 16:23:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tumba](
	[id_tumba] [int] NOT NULL,
	[capacidad] [varchar](50) NULL,
	[extension] [varchar](50) NULL,
	[manzana] [varchar](50) NULL,
	[idtipopk] [int] NULL,
	[idsectorpk] [int] NULL,
 CONSTRAINT [PK_tumba] PRIMARY KEY CLUSTERED 
(
	[id_tumba] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
INSERT [dbo].[asigna_mantenimiento] ([id_asignacion], [fecha_inicio], [fecha_cierra], [cedula_emplpk], [idtipopk], [idmantenimientopk]) VALUES (1, CAST(N'2019-03-22' AS Date), CAST(N'2019-04-22' AS Date), 2123456, 1, 3)
INSERT [dbo].[asigna_mantenimiento] ([id_asignacion], [fecha_inicio], [fecha_cierra], [cedula_emplpk], [idtipopk], [idmantenimientopk]) VALUES (2, CAST(N'2019-01-23' AS Date), CAST(N'2019-04-22' AS Date), 21203458, 2, 1)
GO
INSERT [dbo].[catg_empleado] ([id_categoria], [descripcion_catg]) VALUES (1, N'Administradores')
INSERT [dbo].[catg_empleado] ([id_categoria], [descripcion_catg]) VALUES (2, N'Jardineros')
INSERT [dbo].[catg_empleado] ([id_categoria], [descripcion_catg]) VALUES (3, N'Mantenimiento')
INSERT [dbo].[catg_empleado] ([id_categoria], [descripcion_catg]) VALUES (4, N'Enterradores')
GO
INSERT [dbo].[certificado_defuncion] ([idcertificado], [fecha_fallecimiento], [causa_fallecimiento], [idfallecidopk], [cedulapk]) VALUES (1, CAST(N'2019-03-22' AS Date), N'Covid-19', 123456, 2123456)
INSERT [dbo].[certificado_defuncion] ([idcertificado], [fecha_fallecimiento], [causa_fallecimiento], [idfallecidopk], [cedulapk]) VALUES (2, CAST(N'2019-01-23' AS Date), N'Covid-19', 123457, 2123457)
INSERT [dbo].[certificado_defuncion] ([idcertificado], [fecha_fallecimiento], [causa_fallecimiento], [idfallecidopk], [cedulapk]) VALUES (3, CAST(N'2019-01-25' AS Date), N'Accidente', 123459, 2123459)
INSERT [dbo].[certificado_defuncion] ([idcertificado], [fecha_fallecimiento], [causa_fallecimiento], [idfallecidopk], [cedulapk]) VALUES (4, CAST(N'2019-06-28' AS Date), N'De un susto', 123458, 2123458)
GO
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (1, CAST(302.00 AS Decimal(6, 2)), 2, 1, 2123456)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (2, CAST(209.00 AS Decimal(6, 2)), 2, 2, 2123456)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (3, CAST(150.00 AS Decimal(6, 2)), 2, 1, 2123456)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (4, CAST(200.00 AS Decimal(6, 2)), 2, 2, 2123456)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (5, CAST(209.00 AS Decimal(6, 2)), 1, 2, 2123459)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (6, CAST(250.00 AS Decimal(6, 2)), 3, 3, 2123459)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (8, CAST(150.00 AS Decimal(6, 2)), 1, 1, 2123456)
INSERT [dbo].[compra_panteones] ([id_panteon], [precio], [idtipopk], [idsectorpk], [cedulapk]) VALUES (9, CAST(200.00 AS Decimal(6, 2)), 3, 2, 2123456)
GO
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (2123456, N'Anahi', N'Macias', 991919, CAST(400.00 AS Decimal(6, 2)), 1)
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (13123456, N'Mieguel', N'Macias', 891919, CAST(550.00 AS Decimal(6, 2)), 4)
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (20123457, N'Erika', N'gomez', 918830, CAST(450.00 AS Decimal(6, 2)), 2)
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (21023459, N'juan', N'lopez', 11128, CAST(500.00 AS Decimal(6, 2)), 3)
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (21203458, N'Leo', N'macias', 999933, CAST(510.00 AS Decimal(6, 2)), 4)
INSERT [dbo].[empleado] ([cedula_empl], [nombres_e], [apellidos_e], [telefono], [salario], [idcategoriapk]) VALUES (32012345, N'Erick', N'gomez', 818830, CAST(500.00 AS Decimal(6, 2)), 3)
GO
INSERT [dbo].[fallecido] ([id_fallecido], [nombresf], [apellidosf], [edad]) VALUES (123456, N'dayana', N'Macias', 70)
INSERT [dbo].[fallecido] ([id_fallecido], [nombresf], [apellidosf], [edad]) VALUES (123457, N'carlos', N'gomez', 30)
INSERT [dbo].[fallecido] ([id_fallecido], [nombresf], [apellidosf], [edad]) VALUES (123458, N'alexander', N'macias', 33)
INSERT [dbo].[fallecido] ([id_fallecido], [nombresf], [apellidosf], [edad]) VALUES (123459, N'edison', N'lopez', 28)
GO
INSERT [dbo].[familiar] ([cedula], [nombres], [apellidos], [direccion], [telefono], [correo]) VALUES (2123456, N'Maria', N'Macias', N'barrio jokay', 991919, N'maria@gmail.com')
INSERT [dbo].[familiar] ([cedula], [nombres], [apellidos], [direccion], [telefono], [correo]) VALUES (2123457, N'jose', N'gomez', N'calle 13', 918830, N'jose@gmail.com')
INSERT [dbo].[familiar] ([cedula], [nombres], [apellidos], [direccion], [telefono], [correo]) VALUES (2123458, N'diego', N'macias', N'san pedro', 999933, N'diego@gmail.com')
INSERT [dbo].[familiar] ([cedula], [nombres], [apellidos], [direccion], [telefono], [correo]) VALUES (2123459, N'juan', N'lopez', N'flavio reyes', 11128, N'juan@gmail.com')
GO
INSERT [dbo].[mantenimiento] ([id_mantenimiento], [descripcion_man]) VALUES (1, N'pintura')
INSERT [dbo].[mantenimiento] ([id_mantenimiento], [descripcion_man]) VALUES (2, N'limpieza de lapidas')
INSERT [dbo].[mantenimiento] ([id_mantenimiento], [descripcion_man]) VALUES (3, N'liempeza de maleza')
GO
INSERT [dbo].[sector] ([id_sector], [descripcion_sec], [total_num_tumbas]) VALUES (1, N'sector 1', 200)
INSERT [dbo].[sector] ([id_sector], [descripcion_sec], [total_num_tumbas]) VALUES (2, N'Sector 2', 300)
INSERT [dbo].[sector] ([id_sector], [descripcion_sec], [total_num_tumbas]) VALUES (3, N'Sector 3', 350)
INSERT [dbo].[sector] ([id_sector], [descripcion_sec], [total_num_tumbas]) VALUES (4, N'Sector 4', 360)
GO
INSERT [dbo].[servicio] ([id_servicio], [tipo_servicio], [precio_servicio]) VALUES (1, N'Exhumacion', CAST(80.00 AS Decimal(6, 2)))
INSERT [dbo].[servicio] ([id_servicio], [tipo_servicio], [precio_servicio]) VALUES (2, N'Reubicacion', CAST(120.00 AS Decimal(6, 2)))
INSERT [dbo].[servicio] ([id_servicio], [tipo_servicio], [precio_servicio]) VALUES (3, N'Inhumacion', CAST(200.00 AS Decimal(6, 2)))
INSERT [dbo].[servicio] ([id_servicio], [tipo_servicio], [precio_servicio]) VALUES (4, N'Entierros', CAST(80.00 AS Decimal(6, 2)))
GO
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (1, 1, 123459, 21203458, 1, N'ninguno', CAST(N'2019-06-02' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (2, 1, 123456, 21203458, 1, N'ninguno', CAST(N'2019-06-08' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (3, 2, 123457, 21203458, 1, N'nunguno', CAST(N'2019-06-10' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (4, 3, 123458, 13123456, 1, N'ninguno', CAST(N'2019-06-10' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (5, 1, 123459, 21203458, 4, N'ninguno', CAST(N'2019-06-03' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (6, 1, 123456, 21203458, 4, N'ninguno', CAST(N'2019-06-09' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (7, 2, 123457, 21203458, 4, N'nunguno', CAST(N'2019-06-11' AS Date))
INSERT [dbo].[servicio_prestados] ([id], [idtipopk], [idfallecidopk], [cedula_emplpk], [idserviciopk], [descripcion_servicio], [fecha]) VALUES (8, 3, 123458, 13123456, 4, N'ninguno', CAST(N'2019-06-11' AS Date))
GO
INSERT [dbo].[tipo_tumba] ([id_tipo], [nombre_tumba]) VALUES (1, N'nicho')
INSERT [dbo].[tipo_tumba] ([id_tipo], [nombre_tumba]) VALUES (2, N'panteon')
INSERT [dbo].[tipo_tumba] ([id_tipo], [nombre_tumba]) VALUES (3, N'fosa comun')
GO

-- Consultas 1: Un empleado en cuantas exhumaciones ha estado --
	select f.nombresf as nombre_fallecido, e.tipo_servicio, e.precio_servicio, o.nombres_e as empleado, s.fecha
	from servicio_prestados s 
	inner join  servicio e on s.idserviciopk=e.id_servicio 
	inner join empleado o  on o.cedula_empl= s.cedula_emplpk 
	inner join fallecido f on f.id_fallecido= s.idfallecidopk where id_servicio=1 and  nombres_e= 'Leo'
	select count(tipo_servicio ) as total_Exhumaciones from servicio_prestados s 
	inner join servicio on id_servicio=s.idserviciopk 
	inner join empleado on cedula_empl=s.cedula_emplpk where nombres_e= 'Leo' and id_servicio=1

-- Consulta 2: Numero de tipo de tramites que se ha emitido en el cementerio --
	select  tipo_servicio
	from servicio_prestados s 
	inner join  servicio on id_servicio=s.idserviciopk order by tipo_servicio desc
	select count(tipo_servicio) as total_tramites from servicio_prestados s 
	inner join servicio on id_servicio=s.idserviciopk

-- Consulta 3: Saber los dueños de distintos lugares --
	select f.nombres,t.nombre_tumba ,c.precio,s.descripcion_sec
	from compra_panteones c 
	inner join tipo_tumba t on c.idtipopk=t.id_tipo 
	inner join sector s on s.id_sector= c.idsectorpk 
	inner join familiar f on f.cedula= c.cedulapk order by f.nombres asc

-- Consulta 4: Consulta por fecha de muerte de forma descendente , nombres del fallecido  y  la causa de fallecimiento --
	select  c.fecha_fallecimiento,f.nombresf, c.causa_fallecimiento
	from certificado_defuncion c  
	inner join  fallecido f on c.idfallecidopk = f.id_fallecido order by c.fecha_fallecimiento desc
